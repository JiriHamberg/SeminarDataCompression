% --- Template for thesis / report with tktltiki2 class ---
% 
% last updated 2013/02/15 for tkltiki2 v1.02

\documentclass[english]{tktltiki2}

% tktltiki2 automatically loads babel, so you can simply
% give the language parameter (e.g. finnish, swedish, english, british) as
% a parameter for the class: \documentclass[finnish]{tktltiki2}.
% The information on title and abstract is generated automatically depending on
% the language, see below if you need to change any of these manually.
% 
% Class options:
% - grading                 -- Print labels for grading information on the front page.
% - disablelastpagecounter  -- Disables the automatic generation of page number information
%                              in the abstract. See also \numberofpagesinformation{} command below.
%
% The class also respects the following options of article class:
%   10pt, 11pt, 12pt, final, draft, oneside, twoside,
%   openright, openany, onecolumn, twocolumn, leqno, fleqn
%
% The default font size is 11pt. The paper size used is A4, other sizes are not supported.
%
% rubber: module pdftex

% --- General packages ---

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{amsfonts,amsmath,amssymb,amsthm,booktabs,color,enumitem,graphicx}
\usepackage[pdftex,hidelinks]{hyperref}

%\usepackage{cleveref}

% Automatically set the PDF metadata fields
\makeatletter
\AtBeginDocument{\hypersetup{pdftitle = {\@title}, pdfauthor = {\@author}}}
\makeatother

% --- Language-related settings ---
%
% these should be modified according to your language

% babelbib for non-english bibliography using bibtex
\usepackage[fixlanguage]{babelbib}

% add bibliography to the table of contents
\usepackage[nottoc]{tocbibind}

% --- Theorem environment definitions ---

\newtheorem{thm}{Theorem}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}

\theoremstyle{definition}
\newtheorem{definition}[thm]{Definition}

\theoremstyle{remark}
\newtheorem*{remark}{Remark}


% --- tktltiki2 options ---
%
% The following commands define the information used to generate title and
% abstract pages. The following entries should be always specified:

\title{Data Compression Seminar: wfLZ}
\author{Jiri Hamberg}
\date{\today}
\level{Seminar report}
%\abstract{Abstract.}

% The following can be used to specify keywords and classification of the paper:

\keywords{keyword 1, keyword 2, keyword 3}

% classification according to ACM Computing Classification System (http://www.acm.org/about/class/)
% This is probably mostly relevant for computer scientists
% uncomment the following; contents of \classification will be printed under the abstract with a title
% "ACM Computing Classification System (CCS):"
% \classification{}

% If the automatic page number counting is not working as desired in your case,
% uncomment the following to manually set the number of pages displayed in the abstract page:
%
% \numberofpagesinformation{16 pages + 10 appendix pages}
%
% If you are not a computer scientist, you will want to uncomment the following by hand and specify
% your department, faculty and subject by hand:
%
% \faculty{Faculty of Science}
% \department{Department of Computer Science}
% \subject{Computer Science}
%
% If you are not from the University of Helsinki, then you will most likely want to set these also:
%
% \university{University of Helsinki}
% \universitylong{HELSINGIN YLIOPISTO --- HELSINGFORS UNIVERSITET --- UNIVERSITY OF HELSINKI} % displayed on the top of the abstract page
% \city{Helsinki}
%


\begin{document}

% --- Front matter ---

\frontmatter      % roman page numbering for front matter

\maketitle        % title page
%\makeabstract     % abstract page

\tableofcontents  % table of contents

% --- Main matter ---

\mainmatter       % clear page, start arabic page numbering

\section{Introduction}

wfLZ is an open source Lempel-Ziv compressor developed by Shane Calimlim. The compressor is a C library that is, according to the author, designed for use in game engines with focus in cross platform compatibility. The design is very minimalistic - the entire source code of the library consists of 838 lines of code and one C header file of 144 lines. The compressor has two compression levels, referred here as "fast" and "slow" for clarity. When using the "slow" compression level, the compressor trades compression speed for additional compression ratio. Both algorithms are discussed in detail in section 3.2.  

A notable feature of the wfLZ compressor is that unlike most compressors of the Squash Compression Benchmark, it operates in memory. To achieve streaming to a file, one must utilize some form of memory-to-file mapping, such as \textit{mmap} on Unix-like systems or \textit{File Mapping} on Windows systems, but the library itself offers no direct support for this.

The wfLZ library also has some utility functions for supporting a compression mode called \textit{chunked} compression where the input is divided to equal sized chunks which can be compressed concurrently or in parallel. The API does not exactly implement a parallel compressor but rather offers tools utilities for dividing the data in chunks allowing the user to implement a parallel version of the compressor. This design choice is probably due to trying to keep the project as cross platform compatible as possible. As such, I will not be discussing the chunked compressor mode any further in this report. 

\section{Performance Evaluation}

\begin{figure}
	\includegraphics[width=1.0\textwidth]{../img/dickens_edited.png}
	\caption{
		\textit{dickens}-dataset from the Squash Compression Benchmark. Collected works of Charles Dickens, 9.72 MiB. The wfLZ data points are circled with red. The data points corresponding to the "fast" and "slow" compressor levels are labelled with the words \textit{fast} and \textit{slow} respectively and the data points corresponding to "chunked" compression are labelled with the word \textit{chunked}. 
	}
	\label{fig:dickens}
\end{figure}


\begin{figure}
	\includegraphics[width=1.0\textwidth]{../img/c_source_edited.png}
	\caption{
		\textit{fields.c}-dataset from the Squash Compression Benchmark. Small C-source code of 10.89 KiB. The wfLZ data points are circled with red. The data points corresponding to the "fast" and "slow" compressor levels are labelled with the words \textit{fast} and \textit{slow} respectively and the data points corresponding to "chunked" compression are labelled with the word \textit{chuncked}. 
	}
	\label{fig:csource}
\end{figure}

\begin{figure}
	\includegraphics[width=1.0\textwidth]{../img/wikipedia_decompression.png}
	\caption{
		\textit{enwiki8}-dataset from the Squash Compression Benchmark. First $10^8$ bytes, or 95.37 MiB from the Wikipedia dump. The wfLZ data points are circled with red. The data points corresponding to the "fast" and "slow" compressor levels are labelled with the words \textit{fast} and \textit{slow} respectively and the data points corresponding to "chunked" compression are labelled with the word \textit{chunked}.
	}
	\label{fig:wikipedia}
\end{figure}

The performance of the wfLZ compressor does not stand out favourably in the Squash Compression Benchmark. While using the "fast" compression level, the compression speed is reasonably fast, the compression ratio it achieves is amongst the worst of the compressors with comparable compression speed.

When using the "slow" compression level, the wfLZ compressor is amongst the slowest if not the slowest compressor in most cases. This is made worse by the fact that the compression ratio achieved by with the slow compression level is also the lowest amongst the compressors with comparable compression speeds. In fact, this inequality can be highlighted by choosing a dataset where the "slow" compression algorithm fairs especially poorly, such as the \textit{dickens}-dataset (Collected works of Charles Dickens with combined size of 9.72 MiB). Using this dataset the wfLZ achieved compression speed of only 19.5Kib/s and a compression ratio of 1.71, whereas the fastest compressor using this dataset, density, achieved compression speed of 227.75Mib/s and a very much comparable compression ratio of 1.75. That is a whopping 4 orders of magnitude difference in the compression speed. I will discuss the source of this incredibly poor performance in section 3. Figures~\ref{fig:dickens},\ref{fig:csource} illustrate typical compression speed and compression ratio for the wfLZ compressor with different compressor settings.      

The only metric in the Squash Compression Benchmark where the wfLZ really shines is the decompression speed, where the wfLZ consistently ranks within the top 5 decompressors. This is mostly due to the very simple compression format that the wfLZ uses. The fact that the wfLZ compressor operates in memory might also give it an advantage in the benchmark when compared to decompressors that implement actual file I/O. Figure~\ref{fig:wikipedia} illustrates a typical decompression vs. compression-ratio trade off for the wfLZ compressor.


\section{Compressor Overview}

\subsection{Compression Format}

\subsection{Compression}

\subsection{Decompression}

% Write some science here.

%Sample text and a reference~\cite{example}.


% --- References ---
%
% bibtex is used to generate the bibliography. The babplain style
% will generate numeric references (e.g. [1]) appropriate for theoretical
% computer science. If you need alphanumeric references (e.g [Tur90]), use
%
% \bibliographystyle{babalpha-lf}
%
% instead.

%\bibliographystyle{babplain-lf}
%\bibliography{references-en}


% --- Appendices ---

% uncomment the following

% \newpage
% \appendix
% 
% \section{Example appendix}

\end{document}